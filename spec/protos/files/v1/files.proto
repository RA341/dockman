syntax = "proto3";

package files.v1;

option go_package = "github.com/RA341/dockman/generated/files/v1";

service FileService {
  rpc List(ListRequest) returns (ListResponse) {}
  rpc Create(File) returns (Empty) {}
  rpc Delete(File) returns (Empty) {}
  rpc Exists(File) returns (Empty) {}
  rpc Rename(RenameFile) returns (Empty) {}

  rpc GetDockmanYaml(Empty) returns (DockmanYaml) {}
  rpc Format(FormatRequest) returns (FormatResponse) {}

  rpc ListAlias(ListAliasRequest) returns (ListAliasResponse) {}
  rpc AddAlias(AddAliasRequest) returns (AddAliasResponse) {}
  rpc DeleteAlias(DeleteAliasRequest) returns (DeleteAliasResponse) {}
}

message DeleteAliasRequest {
  Alias alias = 1;
}

message DeleteAliasResponse {}


message AddAliasRequest {
  Alias alias = 1;
}

message AddAliasResponse {}


message ListAliasRequest {
  string host = 1;
}

message Alias {
  string alias = 1;
  string host = 2;
  string fullpath = 3;
}

message ListAliasResponse {
  repeated Alias aliases = 1;
}

message ListRequest {
  string path = 1;
}

message ListResponse {
  repeated FsEntry entries = 1;
}

message FormatRequest {
  string filename = 1;
}

message FormatResponse {
  string contents = 1;
}

message FsEntry {
  string filename = 2;
  bool isDir = 3;
  repeated FsEntry subFiles = 4;
  // flag for lazy loading
  bool isFetched = 5;
  string isComposeFolder = 6;
}

message RenameFile {
  string oldFilePath = 1;
  string newFilePath = 2;
}

message File {
  string filename = 1;
  bool isDir = 2;
}

message Empty {}

message DockmanYaml {
  bool useComposeFolders = 1;
  bool disableComposeQuickActions = 7;
  int32 searchLimit = 8;
  int32 tabLimit = 6;
  VolumesConfig volumesPage = 2;
  NetworkConfig networkPage = 3;
  ImageConfig imagePage = 4;
  ContainerConfig containerPage = 5;
}

message VolumesConfig {
  Sort sort = 1;
}

message NetworkConfig {
  Sort sort = 1;
}

message ImageConfig {
  Sort sort = 1;
}

message ContainerConfig {
  Sort sort = 1;
}


message Sort {
  string sortOrder = 1;
  string sortField = 2;
}
